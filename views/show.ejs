<% layout("layouts/boilerplate") %>

<body>

<div class="showpage" style="width: 18rem;">
    <h3>Listing Details</h3>
  <img src="<%= listing.image.url %>" class="card-img-top" alt="<%= listing.title %>">
  <div class="card-body">
    <p> <b><%= listing.title %></b></p>
    <p class="card-text"><%= listing.description %></p>
    <p>&#8360 <%- listing.price %></p>
    <p><%= listing.location %></p>
    <p><%= listing.country %></p>
    <div class="btns">
      <p><a href="/listing/<%= listing._id %>/edit" class="btn btn-primary">Edit</a></p>
  <form action="/listing/<%= listing.id %>/delete?_method=DELETE" method="post">
    <button class="btn btn-dark" type="submit">Delete</button>
   </form> 
   </div>
  </div>

</div>
<hr>
<div class="mt-5 col-10 offset-3 mb-5">
  <h1 class="mt-5">Leave a Review</h1>
  <form action="/listing/<%= listing._id %>/review" method="post" class="col-8">
    <label for="rating" class="mt-2">Rating:</label> <br>
    <input type="range" min="1" max="5" name="review[rating]" class="form-range"> <br>
    <label for="comment" class="mb-2 mt-2">Comment:</label> <br>
    <textarea rows="5" cols="25" name="review[comment]" id="comment" class="form-control" required></textarea> <br>
    <button class="btn btn-dark">Submit</button>
  </form>
</div>
<div class="showingComment">
  <h4>All Reviews</h4>
  <div class="row">

    <% for (let review of listing.reviews) { %>
      <div class="col-md-4 mb-3">
        <div class="card p-4">
          <h6 class="card-subtitle mb-2 text-body-secondary">
            John Doe
          </h6>

          <p class="card-text"><%= review.comment %></p>

          <p class="card-text">
            <b><%= review.rating %> Stars</b>
          </p>
          <form action="/listing/<%= listing._id %>/review/<%= review._id %>?_method=DELETE" method="post">
            <button class="btn btn-sm btn-dark">Delete</button>
          </form>
        </div>
      </div>
    <% } %>

  </div>
</div>

</body>